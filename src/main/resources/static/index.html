<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ë¡œê·¸ì¸ ì„±ê³µ</title>
  <style>
    :root { --bg:#0b1020; --card:#121931; --text:#e9ecf1; --sub:#9aa4bf; --accent:#7aa2ff; --ok:#3ddc97; --err:#ff6b6b; }
    * { box-sizing: border-box; }
    body {
      margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      background: radial-gradient(1200px 800px at 100% -20%, #1b2550, #0b1020);
      color: var(--text); min-height: 100svh; display: grid; place-items: center; padding: 24px;
    }
    .card {
      width: 100%; max-width: 760px; background: linear-gradient(180deg, #141c38, #101731);
      border: 1px solid rgba(255,255,255,.08); border-radius: 16px; box-shadow: 0 20px 60px rgba(0,0,0,.35);
      padding: 24px;
    }
    h1 { margin: 0 0 8px; font-size: 22px; letter-spacing: .1px; }
    p.desc { margin: 0 0 18px; color: var(--sub); line-height: 1.5; }
    .row { display: flex; gap: 12px; flex-wrap: wrap; margin: 12px 0 20px; }
    button, a.btn {
      appearance: none; border: 1px solid rgba(255,255,255,.12); color: var(--text);
      background: #0f1530; padding: 10px 14px; border-radius: 10px; cursor: pointer; text-decoration: none;
    }
    button:hover, a.btn:hover { border-color: rgba(255,255,255,.3); }
    .hint { font-size: 13px; color: var(--sub); margin-top: -6px; }
    pre {
      margin: 0; background: #0b1126; color: #d9e1ff; border: 1px solid rgba(255,255,255,.08);
      padding: 14px; border-radius: 10px; max-height: 420px; overflow: auto; font-size: 13px;
    }
    .tag { display: inline-block; padding: 2px 8px; border-radius: 999px; font-size: 12px; margin-left: 8px; background: rgba(122,162,255,.15); color: var(--accent); border: 1px solid rgba(122,162,255,.35);}
    .ok { color: var(--ok); }
    .err { color: var(--err); }
    .footer { margin-top: 14px; font-size: 12px; color: var(--sub); }
  </style>
</head>
<body>
<main class="card">
  <h1>ë¡œê·¸ì¸ ì„±ê³µ ğŸ‰ <span id="statusTag" class="tag">ì¿ í‚¤ ì„¤ì •ë¨</span></h1>
  <p class="desc">
    ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì™„ë£Œ! ì„œë²„ê°€ <code>HttpOnly</code> ì¿ í‚¤ë¡œ í† í°ì„ ì„¤ì •í–ˆì–´ìš”.
    ì•„ë˜ ë²„íŠ¼ìœ¼ë¡œ ë³´í˜¸ëœ API í˜¸ì¶œì´ ë˜ëŠ”ì§€ ë°”ë¡œ í™•ì¸í•´ë³´ì„¸ìš”.
  </p>

  <div class="row">
    <a id="btnSwagger" class="btn" href="#">Swagger ì—´ê¸°</a>
    <button id="btnMe">API í˜¸ì¶œ</button>
  </div>
  <div class="hint">ì°¸ê³ : <code>HttpOnly</code> ì¿ í‚¤ëŠ” JSì—ì„œ ì½ì„ ìˆ˜ ì—†ì§€ë§Œ, ê°™ì€ ì˜¤ë¦¬ì§„ ìš”ì²­ ì‹œ ìë™ìœ¼ë¡œ ì „ì†¡ë©ë‹ˆë‹¤.</div>

  <h2 style="margin:20px 0 10px; font-size:16px;">ì‘ë‹µ</h2>
  <pre id="output">{ ì—¬ê¸°ì— ì‘ë‹µì´ í‘œì‹œë©ë‹ˆë‹¤ }</pre>

  <div class="footer">
    ë¬¸ì œê°€ ìˆë‚˜ìš”? <span class="err">401/403</span>ì´ë©´ í† í° ë¯¸ì „ë‹¬ ê°€ëŠ¥ì„±,
    <span class="err">404</span>ë©´ ê²½ë¡œ ë¯¸ë§¤í•‘ ê°€ëŠ¥ì„±ì„ í™•ì¸í•˜ì„¸ìš”.
  </div>
</main>

<script>
  const $ = s => document.querySelector(s);
  const out = $("#output");
  const statusTag = $("#statusTag");

  // ğŸ”¹ context-path ìë™ ê°ì§€ (/user or '')
  const contextPath = window.location.pathname.split('/')[1] || '';
  const base = contextPath ? `/${contextPath}` : '';

  // ğŸ”¹ Swagger ë§í¬ ìë™ ì„¤ì •
  $("#btnSwagger").href = `${base}/swagger-ui.html`;

  // ğŸ”¹ ë²„íŠ¼ í…ìŠ¤íŠ¸ ë™ì  í‘œì‹œ
  $("#btnMe").textContent = `${base || ''}/auth/me í˜¸ì¶œ`;

  async function callMe() {
    out.textContent = "ìš”ì²­ ì¤‘...";
    try {
      const res = await fetch(`${base}/auth/me`, {
        method: "GET",
        credentials: "include"
      });
      const text = await res.text();
      let pretty = text;
      try { pretty = JSON.stringify(JSON.parse(text), null, 2); } catch {}
      out.textContent = `HTTP ${res.status}\n\n${pretty}`;
      statusTag.textContent = res.ok ? "ì¸ì¦ OK" : "ì¸ì¦ ì‹¤íŒ¨";
      statusTag.style.borderColor = res.ok ? "rgba(61,220,151,.5)" : "rgba(255,107,107,.5)";
      statusTag.style.background = res.ok ? "rgba(61,220,151,.12)" : "rgba(255,107,107,.12)";
      statusTag.style.color = res.ok ? "var(--ok)" : "var(--err)";
    } catch (e) {
      out.textContent = "ì˜¤ë¥˜: " + (e?.message || e);
      statusTag.textContent = "ì—ëŸ¬";
      statusTag.classList.add("err");
    }
  }

  $("#btnMe").addEventListener("click", callMe);
</script>
</body>
</html>